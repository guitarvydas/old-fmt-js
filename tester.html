<!DOCTYPE html>
<html>
<head>
<style>
textarea {
}
</style>
</head>
<body>

<h1>Simplistic Transpile Tester</h1>

<button onclick="test ()">Test</button>
<br>

<p>source:</p>
<textarea id="src" rows="7" cols="90" placeholder="src" style="background-color:oldlace;">
abc
</textarea>


<p>transpiled:</p>
<textarea id="output" rows="7" cols="90" placeholder="transpiled"  readonly style="background-color:whitesmoke;">
</textarea>
<br>
<br>
<p id="status" > READY </p>
<br>
<br>
<br>

<!-- Ohm-JS -->
<script src="https://unpkg.com/ohm-js@16/dist/ohm.min.js"></script>


<script src="transpile.js"></script>


<script>

  const testgrammar = String.raw`
grammar {
main = lexA lexB lexC
lexA = "a"
lexB = "b"
lexC = "c"
}
`;

  const testfmt = String.raw`
main [A B C] = ‛«A»«B»«C»’
lexA [k] = ‛«k»’
lexB [k] = ‛«k»’
lexC [k] = ‛«k»’
`;

  function test () {
      [success, str] = transpile (src, testgrammar, testfmt);

  
  function generate () {
      let src = document.getElementById('src').value;
      try {
          let [success, expanded] = fmtjs (src);
          document.getElementById('output').value = expanded;
          if (success) {
              document.getElementById('status').innerHTML = "OK";
          } else {
              document.getElementById('status').innerHTML = "FAILED";
          }
      } catch (err) {
          document.getElementById('status').innerHTML = "parse FAILED: " + err.message;
      }
  }

  // helper functions
  var ruleName = "???";
  function setRuleName (s) { ruleName = s; return "";}
  function getRuleName () { return ruleName; }


  </script>
</body>
</html>


